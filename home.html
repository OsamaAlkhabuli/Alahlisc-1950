
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ</title>
  <style>
    body { font-family: 'Cairo', sans-serif; background: #f9f9f9; margin: 0; }
    header, footer {
      background: #006400; color: goldenrod; padding: 15px;
      text-align: center; font-weight: bold;
    }
    nav {
      background: #eee; padding: 10px;
      display: flex; justify-content: center; gap: 10px;
    }
    .tab-btn {
      padding: 10px 20px; border: none;
      background: goldenrod; color: white; border-radius: 5px;
      cursor: pointer;
    }
    .tab-btn.active { background: #006400; }
    .tab-content { display: none; padding: 20px; }
    .tab-content.active { display: block; }
    input, select {
      margin: 5px; padding: 5px; min-width: 150px;
      border-radius: 6px; border: 1px solid #ccc;
    }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; background: white; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    th { background-color: #006400; color: white; }
  </style>
</head>
<body>
  <header>
    Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø£Ù‡Ù„ÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ<br>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±<br>Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ Ù„Ù„Ù†Ø§Ø¯ÙŠ
  </header>

  <nav>
    <button class="tab-btn active" onclick="showTab(0)">Ø§Ù„ÙƒØ§Ù…Ù„Ø©</button>
    <button class="tab-btn" onclick="showTab(1)">ØºÙŠØ± ÙƒØ§Ù…Ù„Ø©</button>
    <button class="tab-btn" onclick="showTab(2)">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©</button>
  </nav>

  <div class="tab-content active" id="tab0">
    <input placeholder="ğŸ” Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±" id="search0">
    <select id="filter0"><option value="">ğŸ“‚ ÙƒÙ„ Ø§Ù„Ù…Ø±Ø§Ø­Ù„</option></select>
    
<input type="text" id="searchInput" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø£Ùˆ Ù…Ø±Ø­Ù„Ø©..." 
       onkeyup="smartSearch('searchInput', 'tenantsTable')" 
       style="padding: 10px; width: 300px; margin-bottom: 20px; display: block; margin-right: auto; margin-left: auto; border: 1px solid #ccc; border-radius: 6px;">

<div style="margin: 10px 0; text-align: center;">
  <button onclick="exportToExcel()" style="padding: 8px 16px; background: green; color: white; border: none; border-radius: 6px;">ğŸ“¥ Excel</button>
  <button onclick="exportToPDF()" style="padding: 8px 16px; background: goldenrod; color: white; border: none; border-radius: 6px;">ğŸ“„ PDF</button>
</div>

<div id="table0"></div>
  </div>
  <div class="tab-content" id="tab1">
    <input placeholder="ğŸ” Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±" id="search1">
    <select id="filter1"><option value="">ğŸ“‚ ÙƒÙ„ Ø§Ù„Ù…Ø±Ø§Ø­Ù„</option></select>
    <div id="table1"></div>
  </div>
  <div class="tab-content" id="tab2">
    <input placeholder="ğŸ” Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±" id="search2">
    <select id="filter2"><option value="">ğŸ“‚ ÙƒÙ„ Ø§Ù„Ù…Ø±Ø§Ø­Ù„</option></select>
    <div id="table2"></div>
  </div>

  <footer>ØªØµÙ…ÙŠÙ… ÙˆØ¨Ø±Ù…Ø¬Ø©: Ù…. Ø£Ø³Ø§Ù…Ø© Ø§Ù„Ø®Ø¨ÙˆÙ„ÙŠ - 2025</footer>

  <script>
    function showTab(index) {
      document.querySelectorAll('.tab-content').forEach((el, i) => {
        el.classList.toggle('active', i === index);
      });
      document.querySelectorAll('.tab-btn').forEach((btn, i) => {
        btn.classList.toggle('active', i === index);
      });
    }

    async function fetchAndRender() {
      const res = await fetch('tenants_data.json');
      const json = await res.json();
      const sections = [json.complete, json.not_completed, json.legal_review];

      sections.forEach((rows, idx) => {
        const search = document.getElementById('search' + idx);
        const filter = document.getElementById('filter' + idx);
        const container = document.getElementById('table' + idx);

        const phases = [...new Set(rows.map(r => r['Ø§Ù„Ù…Ø±Ø­Ù„Ø©']))];
        filter.innerHTML += phases.map(p => `<option value="${p}">${p}</option>`).join('');

        function render() {
          const q = search.value.trim();
          const f = filter.value;
          const filtered = rows.filter(r =>
            (!q || (r['Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±'] || '').includes(q)) &&
            (!f || r['Ø§Ù„Ù…Ø±Ø­Ù„Ø©'] == f)
          );
          const cols = Object.keys(filtered[0] || {});
          let html = '<table id="tenantsTable"><thead><tr>' + cols.map(c => `<th>${c}</th>`).join('') + '</tr></thead><tbody>';
          html += filtered.map(r => '<tr>' + cols.map(c => `<td>${r[c]}</td>`).join('') + '</tr>').join('');
          html += '</tbody></table>';
          container.innerHTML = html || '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</p>';
        }

        search.oninput = filter.onchange = render;
        render();
      });
    }

    window.onload = fetchAndRender;
  </script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
function smartSearch(inputId, tableId) {
  const input = document.getElementById(inputId);
  const filter = input.value.toLowerCase();
  const table = document.getElementById(tableId);
  const rows = table.getElementsByTagName('tr');

  for (let i = 1; i < rows.length; i++) {
    let show = false;
    const cells = rows[i].getElementsByTagName('td');
    for (let j = 0; j < cells.length; j++) {
      const cellValue = cells[j].textContent || cells[j].innerText;
      if (cellValue.toLowerCase().includes(filter)) {
        show = true;
        break;
      }
    }
    rows[i].style.display = show ? '' : 'none';
  }
}

function exportToExcel() {
  const table = document.getElementById("tenantsTable");
  const wb = XLSX.utils.table_to_book(table, {sheet: "Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±ÙŠÙ†"});
  XLSX.writeFile(wb, "tenants_export.xlsx");
}

function exportToPDF() {
  const element = document.getElementById("tenantsTable");
  const opt = {
    margin: 0.5,
    filename: 'tenants_export.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'in', format: 'a4', orientation: 'landscape' }
  };
  html2pdf().set(opt).from(element).save();
}
</script>

</body>
</html>
