
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø§Ù‡Ù„ÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</title>
    <title>Ø§Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: 'Cairo', sans-serif; margin: 20px; background: #f0f0f0; direction: rtl; }
    h1 { text-align: center; color: #006400; }
    nav { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
    .tab-btn {
      padding: 10px 20px; border: none; border-radius: 8px;
      background-color: #006400; color: white; cursor: pointer;
    }
    .tab-btn.active { background-color: goldenrod; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .filters input, .filters select {
      padding: 5px 10px; margin-left: 10px; min-width: 160px;
    }
    .exportBtn { margin-right: 10px; }
    table { width: 100%; border-collapse: collapse; background: white; min-width: 1200px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; white-space: nowrap; }
    th { background-color: #006400; color: white; }
    .table-wrapper { overflow-x: auto; }
  </style>
</head>
<body>
  <h1>ðŸ“Š Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ - Ø§Ù„Ø£Ù‡Ù„ÙŠ 2025 </h1>
  <nav id="nav"></nav>
  <div id="tabs"></div>

  <script>
    const tabMap = {
      "complete": "Ø§Ù„ÙƒØ§Ù…Ù„Ø©",
      "not_completed": "ØºÙŠØ± ÙƒØ§Ù…Ù„Ø©",
      "additions": "Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª",
      "legal_review": "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©"
    };
    let data = {};
    const tabsContainer = document.getElementById('tabs');

    function showTab(i) {
      document.querySelectorAll('.tab-content').forEach((el, idx) => {
        el.classList.toggle('active', idx === i);
      });
      document.querySelectorAll('.tab-btn').forEach((btn, idx) => {
        btn.classList.toggle('active', idx === i);
      });
    }

    function buildTabs() {
      const nav = document.getElementById('nav');
      const keys = Object.keys(tabMap);
      keys.forEach((key, idx) => {
        const rows = data[key];
        if (!rows || !rows.length) return;
        const columns = Object.keys(rows[0]);

        const btn = document.createElement('button');
        btn.className = 'tab-btn' + (idx === 0 ? ' active' : '');
        btn.textContent = tabMap[key];
        btn.onclick = () => showTab(idx);
        nav.appendChild(btn);

        const tab = document.createElement('div');
        tab.className = 'tab-content' + (idx === 0 ? ' active' : '');
        tab.innerHTML = `
          <div class="filters">
            <input class="nameFilter" placeholder="ðŸ” Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±">
            <select class="phaseFilter"><option value="">ðŸ“‚ ÙƒÙ„ Ø§Ù„Ù…Ø±Ø§Ø­Ù„</option></select>
            <button class="exportBtn">ðŸ“¤ ØªØµØ¯ÙŠØ± Excel</button>
          </div>
          <div class="table-wrapper">
            <table>
              <thead><tr>\${columns.map(c => `<th>\${c}</th>`).join('')}</tr></thead>
              <tbody></tbody>
            </table>
          </div>
        `;
        tabsContainer.appendChild(tab);

        const tbody = tab.querySelector('tbody');
        const filterName = tab.querySelector('.nameFilter');
        const filterPhase = tab.querySelector('.phaseFilter');
        const exportBtn = tab.querySelector('.exportBtn');

        const phases = [...new Set(rows.map(r => r['Ø§Ù„Ù…Ø±Ø­Ù„Ø©']).filter(Boolean))];
        phases.forEach(p => {
          const opt = document.createElement('option');
          opt.value = p;
          opt.textContent = p;
          filterPhase.appendChild(opt);
        });

        function applyFilters() {
          tbody.innerHTML = '';
          const nameVal = filterName.value.trim();
          const phaseVal = filterPhase.value;
          const filtered = rows.filter(r =>
            (!nameVal || (r['Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±'] || '').includes(nameVal)) &&
            (!phaseVal || r['Ø§Ù„Ù…Ø±Ø­Ù„Ø©'] === phaseVal)
          );
          filtered.forEach(row => {
            const tr = document.createElement('tr');
            columns.forEach(col => {
              tr.innerHTML += `<td>\${row[col] || ''}</td>`;
            });
            tbody.appendChild(tr);
          });
        }

        filterName.oninput = applyFilters;
        filterPhase.onchange = applyFilters;
        exportBtn.onclick = () => {
          const tbl = tab.querySelector('table');
          const wb = XLSX.utils.table_to_book(tbl, { sheet: "Ø¨ÙŠØ§Ù†Ø§Øª" });
          XLSX.writeFile(wb, `table_\${key}.xlsx`);
        };
        applyFilters();
      });
    }

    fetch('alahlisc (1).json')
      .then(res => res.json())
      .then(json => {
        data = json;
        buildTabs();
      });
  </script>
</body>
</html>
