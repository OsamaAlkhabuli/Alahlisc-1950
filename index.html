<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>  ุงุฏุงุฑุฉ ุงูุงุณุชุซูุงุฑ -ูุงุฏู ุงูุฃููู </title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: 'Cairo', sans-serif; margin: 20px; background: #f9f9f9; }
    h1 { text-align: center; color: #006400; }
    nav { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
    .tab-btn {
      padding: 10px 20px; border: none; border-radius: 8px;
      background-color: #006400; color: white; cursor: pointer;
    }
    .tab-btn.active { background-color: goldenrod; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .filters input, .filters select {
      padding: 5px 10px; margin-left: 10px; min-width: 160px;
    }
    table { width: 100%; border-collapse: collapse; background: white; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; white-space: nowrap; }
    th { background-color: #006400; color: white; }
  </style>
</head>
<body>
  <h1>๐ ููุญุฉ ุงููุธุงู ุงูุงุณุชุซูุงุฑู - ุงููุงุฏู ุงูุฃููู 2025</h1>
  <nav>
    <button class="tab-btn active" onclick="showTab(0)">ูุณุชููู ุงูุนููุฏ</button>
    <button class="tab-btn" onclick="showTab(1)">ูุณุชูููู ุงูุงูุชุฒุงู</button>
    <button class="tab-btn" onclick="showTab(2)">ุนูููู ุงูุชุฒุงู</button>
    <button class="tab-btn" onclick="showTab(3)">ููุงูุต ููุฑุงุฌุนุฉ</button>
  </nav>

  <div class="tab-content active" id="tab0">
    <div class="filters">
      <input class="nameFilter" placeholder="๐ ุงุณู ุงููุณุชุฃุฌุฑ">
      <select class="phaseFilter"><option value="">๐ ูู ุงููุฑุงุญู</option></select>
      <button class="exportBtn">๐ค ุชุตุฏูุฑ Excel</button>
    </div>
    <table><thead><tr><th>ุงููุณุชุฃุฌุฑ</th><th>ุงููุฑุญูุฉ</th><th>ุงูุฏูุฑ</th><th>ุฑูู ุงููุญู</th><th>ุงูุฅูุฌุงุฑ</th><th>ููุฏู ุงูุนูุฏ</th><th>ูููุฉ ุงูุงุณุชุซูุงุฑ</th><th>ูููุฉ ุงูุชุทููุฑ</th><th>ุชุงุฑูุฎ ุขุฎุฑ ุณุฏุงุฏ</th><th>ุงูุจุงูู</th><th>ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุนูุฏ</th><th>ุชุงุฑูุฎ ููุงูุฉ ุงูุนูุฏ</th><th>ููุงุญุธุงุช</th><th>ุงููููุฉ ุงููุฏููุนุฉ</th><th>ุฑูู ุงูุฅูุตุงู</th></tr></thead><tbody id="body0"></tbody></table>
  </div>

  <div class="tab-content" id="tab1">
    <div class="filters">
      <input class="nameFilter" placeholder="๐ ุงุณู ุงููุณุชุฃุฌุฑ">
      <select class="phaseFilter"><option value="">๐ ูู ุงููุฑุงุญู</option></select>
      <button class="exportBtn">๐ค ุชุตุฏูุฑ Excel</button>
    </div>
    <table><thead><tr><th>ุงููุณุชุฃุฌุฑ</th><th>ุงููุฑุญูุฉ</th><th>ุงูุฏูุฑ</th><th>ุฑูู ุงููุญู</th><th>ุงูุฅูุฌุงุฑ</th><th>ููุฏู ุงูุนูุฏ</th><th>ูููุฉ ุงูุงุณุชุซูุงุฑ</th><th>ูููุฉ ุงูุชุทููุฑ</th><th>ุชุงุฑูุฎ ุขุฎุฑ ุณุฏุงุฏ</th><th>ุงูุจุงูู</th><th>ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุนูุฏ</th><th>ุชุงุฑูุฎ ููุงูุฉ ุงูุนูุฏ</th><th>ููุงุญุธุงุช</th><th>ุงููููุฉ ุงููุฏููุนุฉ</th><th>ุฑูู ุงูุฅูุตุงู</th></tr></thead><tbody id="body1"></tbody></table>
  </div>

  <div class="tab-content" id="tab2">
    <div class="filters">
      <input class="nameFilter" placeholder="๐ ุงุณู ุงููุณุชุฃุฌุฑ">
      <select class="phaseFilter"><option value="">๐ ูู ุงููุฑุงุญู</option></select>
      <button class="exportBtn">๐ค ุชุตุฏูุฑ Excel</button>
    </div>
    <table><thead><tr><th>ุงููุณุชุฃุฌุฑ</th><th>ุงููุฑุญูุฉ</th><th>ุงูุฏูุฑ</th><th>ุฑูู ุงููุญู</th><th>ุงูุฅูุฌุงุฑ</th><th>ููุฏู ุงูุนูุฏ</th><th>ูููุฉ ุงูุงุณุชุซูุงุฑ</th><th>ูููุฉ ุงูุชุทููุฑ</th><th>ุชุงุฑูุฎ ุขุฎุฑ ุณุฏุงุฏ</th><th>ุงูุจุงูู</th><th>ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุนูุฏ</th><th>ุชุงุฑูุฎ ููุงูุฉ ุงูุนูุฏ</th><th>ููุงุญุธุงุช</th><th>ุงููููุฉ ุงููุฏููุนุฉ</th><th>ุฑูู ุงูุฅูุตุงู</th></tr></thead><tbody id="body2"></tbody></table>
  </div>

  <div class="tab-content" id="tab3">
    <div class="filters">
      <input class="nameFilter" placeholder="๐ ุงุณู ุงููุณุชุฃุฌุฑ">
      <select class="phaseFilter"><option value="">๐ ูู ุงููุฑุงุญู</option></select>
      <button class="exportBtn">๐ค ุชุตุฏูุฑ Excel</button>
    </div>
    <table><thead><tr><th>ุงููุณุชุฃุฌุฑ</th><th>ุงููุฑุญูุฉ</th><th>ุงูุฏูุฑ</th><th>ุฑูู ุงููุญู</th><th>ุงูุฅูุฌุงุฑ</th><th>ููุฏู ุงูุนูุฏ</th><th>ูููุฉ ุงูุงุณุชุซูุงุฑ</th><th>ูููุฉ ุงูุชุทููุฑ</th><th>ุชุงุฑูุฎ ุขุฎุฑ ุณุฏุงุฏ</th><th>ุงูุจุงูู</th><th>ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุนูุฏ</th><th>ุชุงุฑูุฎ ููุงูุฉ ุงูุนูุฏ</th><th>ููุงุญุธุงุช</th><th>ุงููููุฉ ุงููุฏููุนุฉ</th><th>ุฑูู ุงูุฅูุตุงู</th></tr></thead><tbody id="body3"></tbody></table>
  </div>

<script>
  // ุชุนููู ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูุน ุงูููุงุชูุญ ุงูููุงุจูุฉ ูู JSON
  const columns = [
    {key: "ุงููุณุชุงุฌุฑ", name: "ุงููุณุชุฃุฌุฑ"},
    {key: "ุงููุฑุญูุฉ", name: "ุงููุฑุญูุฉ"},
    {key: "ุงูุฏูุฑ", name: "ุงูุฏูุฑ"},
    {key: "ุฑูู ุงููุญู", name: "ุฑูู ุงููุญู"},
    {key: "ุงูุงูุฌุงุฑ", name: "ุงูุฅูุฌุงุฑ"},
    {key: "ููุฏู ุงูุนูุฏ", name: "ููุฏู ุงูุนูุฏ"},
    {key: "ููุฏู ุงูุนูุฏ", name: "ูููุฉ ุงูุงุณุชุซูุงุฑ"}, // ููุงุญุธุฉ: ููุณ ุงูููุชุงุญ
    {key: "Unnamed: 7", name: "ูููุฉ ุงูุชุทููุฑ"},
    {key: "ุชุงุฑูุฎ ุงุฎุฑ ุณุฏุงุฏ", name: "ุชุงุฑูุฎ ุขุฎุฑ ุณุฏุงุฏ"},
    {key: "ุงูุจุงูู", name: "ุงูุจุงูู"},
    {key: "ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุนูุฏ", name: "ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุนูุฏ"},
    {key: "ุชุงุฑูุฎ ููุงูุฉ ุงูุนูุฏ", name: "ุชุงุฑูุฎ ููุงูุฉ ุงูุนูุฏ"},
    {key: "ููุงุญุธุงุช", name: "ููุงุญุธุงุช"},
    {key: "ุงููููุฉ ุงููุฏููุนุฉ", name: "ุงููููุฉ ุงููุฏููุนุฉ"},
    {key: "ุฑูู ุงูุงูุตุงู", name: "ุฑูู ุงูุฅูุตุงู"}
  ];

  let data = {};

  function showTab(i) {
    document.querySelectorAll('.tab-content').forEach((el, idx) => {
      el.classList.toggle('active', i === idx);
    });
    document.querySelectorAll('.tab-btn').forEach((btn, idx) => {
      btn.classList.toggle('active', i === idx);
    });
  }

  function mapRowToColumns(row) {
    const mapped = {};
    columns.forEach(col => {
      mapped[col.name] = row[col.key] || "";
    });
    return mapped;
  }

  function renderTables() {
    // ุชุนููู ุงูุจูุงูุงุช ูู JSON ุฅูู ุงูุฃูุณุงู ุงูููุงุณุจุฉ
    const sections = [
      data.complete ? data.complete.slice(1) : [], // ุชุฌุงูู ุงูุตู ุงูุฃูู (ุงูุนูุงููู)
      data.not_completed ? data.not_completed.slice(3) : [], // ุชุฌุงูู ุงูุตููู ุงูุฃููู (ุงูุนูุงููู)
      data.additions ? data.additions.slice(2) : [], // ุชุฌุงูู ุงูุตููู ุงูุฃููู (ุงูุนูุงููู)
      data.legal_review ? data.legal_review.slice(2) : [] // ุชุฌุงูู ุงูุตููู ุงูุฃููู (ุงูุนูุงููู)
    ];
    
    sections.forEach((rows, i) => {
      const tbody = document.getElementById('body' + i);
      const filterName = document.querySelectorAll('.nameFilter')[i];
      const filterPhase = document.querySelectorAll('.phaseFilter')[i];
      const exportBtn = document.querySelectorAll('.exportBtn')[i];

      // ูุณุญ ุฎูุงุฑุงุช ุงููุฑุญูุฉ ุงูุญุงููุฉ
      while (filterPhase.options.length > 1) {
        filterPhase.remove(1);
      }

      // ุฅุถุงูุฉ ุฎูุงุฑุงุช ุงููุฑุญูุฉ
      const phases = [...new Set(rows.map(r => r['ุงููุฑุญูุฉ']))].filter(Boolean);
      phases.forEach(p => {
        const opt = document.createElement('option');
        opt.value = p; opt.textContent = p;
        filterPhase.appendChild(opt);
      });

      function applyFilters() {
        tbody.innerHTML = '';
        const nameVal = filterName.value.trim();
        const phaseVal = filterPhase.value;
        
        const filtered = rows.filter(r => {
          const tenantName = r['ุงููุณุชุงุฌุฑ'] || r['Unnamed: 1'] || '';
          const phase = r['ุงููุฑุญูุฉ'] || r['Unnamed: 2'] || '';
          
          return (!nameVal || tenantName.includes(nameVal)) &&
                 (!phaseVal || phase === phaseVal);
        });

        filtered.forEach(row => {
          const mappedRow = mapRowToColumns(row);
          const tr = document.createElement('tr');
          
          columns.forEach(col => {
            tr.innerHTML += `<td>${mappedRow[col.name] || ""}</td>`;
          });
          
          tbody.appendChild(tr);
        });
      }

      filterName.oninput = applyFilters;
      filterPhase.onchange = applyFilters;
      applyFilters();

      exportBtn.onclick = () => {
        const tbl = exportBtn.closest('.tab-content').querySelector('table');
        const wb = XLSX.utils.table_to_book(tbl, { sheet: "ุจูุงูุงุช" });
        XLSX.writeFile(wb, 'table' + i + '.xlsx');
      };
    });
  }

  // ุชุญููู ุงูุจูุงูุงุช ูู ููู JSON
  fetch('alahlisc (1).json')
    .then(res => res.json())
    .then(json => {
      data = json; 
      renderTables();
    })
    .catch(err => {
      console.error('Error loading data:', err);
      alert('ุญุฏุซ ุฎุทุฃ ูู ุชุญููู ุงูุจูุงูุงุช. ุงูุฑุฌุงุก ุงูุชุญูู ูู ููู JSON.');
    });
</script>
</body>
</html>
