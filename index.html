
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ุงููุธุงู ุงูุงุณุชุซูุงุฑู - ุงูุฃููู 2025</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: 'Cairo', sans-serif; margin: 20px; background: #f9f9f9; }
    h1 { text-align: center; color: #006400; }
    nav { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
    .tab-btn {
      padding: 10px 20px; border: none; border-radius: 8px;
      background-color: #006400; color: white; cursor: pointer;
    }
    .tab-btn.active { background-color: goldenrod; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .filters input, .filters select {
      padding: 5px 10px; margin-left: 10px; min-width: 160px;
    }
    table { width: 100%; border-collapse: collapse; background: white; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; white-space: nowrap; }
    th { background-color: #006400; color: white; }
  </style>
</head>
<body>
  <h1>๐ ููุญุฉ ุงููุธุงู ุงูุงุณุชุซูุงุฑู - ุงููุงุฏู ุงูุฃููู 2025</h1>
  <nav>
    <button class="tab-btn active" onclick="showTab(0)">ูุณุชููู ุงูุนููุฏ</button>
    <button class="tab-btn" onclick="showTab(1)">ูุณุชูููู ุงูุงูุชุฒุงู</button>
    <button class="tab-btn" onclick="showTab(2)">ุนูููู ุงูุชุฒุงู</button>
    <button class="tab-btn" onclick="showTab(3)">ููุงูุต ููุฑุงุฌุนุฉ</button>
  </nav>

  <div class="tab-content active" id="tab0">
    <div class="filters">
      <input class="nameFilter" placeholder="๐ ุงุณู ุงููุณุชุฃุฌุฑ">
      <select class="phaseFilter"><option value="">๐ ูู ุงููุฑุงุญู</option></select>
      <button class="exportBtn">๐ค ุชุตุฏูุฑ Excel</button>
    </div>
    <table><thead><tr><th>ุงููุณุชุฃุฌุฑ</th><th>ุงููุฑุญูุฉ</th><th>ุงูุฏูุฑ</th><th>ุฑูู ุงููุญู</th><th>ุงูุฅูุฌุงุฑ</th><th>ููุฏู ุงูุนูุฏ</th><th>ูููุฉ ุงูุงุณุชุซูุงุฑ</th><th>ูููุฉ ุงูุชุทููุฑ</th><th>ุชุงุฑูุฎ ุขุฎุฑ ุณุฏุงุฏ</th><th>ุงูุจุงูู</th><th>ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุนูุฏ</th><th>ุชุงุฑูุฎ ููุงูุฉ ุงูุนูุฏ</th><th>ููุงุญุธุงุช</th><th>ุงููููุฉ ุงููุฏููุนุฉ</th><th>ุฑูู ุงูุฅูุตุงู</th></tr></thead><tbody id="body0"></tbody></table>
  </div>

  <div class="tab-content" id="tab1">
    <div class="filters">
      <input class="nameFilter" placeholder="๐ ุงุณู ุงููุณุชุฃุฌุฑ">
      <select class="phaseFilter"><option value="">๐ ูู ุงููุฑุงุญู</option></select>
      <button class="exportBtn">๐ค ุชุตุฏูุฑ Excel</button>
    </div>
    <table><thead><tr><th>ุงููุณุชุฃุฌุฑ</th><th>ุงููุฑุญูุฉ</th><th>ุงูุฏูุฑ</th><th>ุฑูู ุงููุญู</th><th>ุงูุฅูุฌุงุฑ</th><th>ููุฏู ุงูุนูุฏ</th><th>ูููุฉ ุงูุงุณุชุซูุงุฑ</th><th>ูููุฉ ุงูุชุทููุฑ</th><th>ุชุงุฑูุฎ ุขุฎุฑ ุณุฏุงุฏ</th><th>ุงูุจุงูู</th><th>ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุนูุฏ</th><th>ุชุงุฑูุฎ ููุงูุฉ ุงูุนูุฏ</th><th>ููุงุญุธุงุช</th><th>ุงููููุฉ ุงููุฏููุนุฉ</th><th>ุฑูู ุงูุฅูุตุงู</th></tr></thead><tbody id="body1"></tbody></table>
  </div>

  <div class="tab-content" id="tab2">
    <div class="filters">
      <input class="nameFilter" placeholder="๐ ุงุณู ุงููุณุชุฃุฌุฑ">
      <select class="phaseFilter"><option value="">๐ ูู ุงููุฑุงุญู</option></select>
      <button class="exportBtn">๐ค ุชุตุฏูุฑ Excel</button>
    </div>
    <table><thead><tr><th>ุงููุณุชุฃุฌุฑ</th><th>ุงููุฑุญูุฉ</th><th>ุงูุฏูุฑ</th><th>ุฑูู ุงููุญู</th><th>ุงูุฅูุฌุงุฑ</th><th>ููุฏู ุงูุนูุฏ</th><th>ูููุฉ ุงูุงุณุชุซูุงุฑ</th><th>ูููุฉ ุงูุชุทููุฑ</th><th>ุชุงุฑูุฎ ุขุฎุฑ ุณุฏุงุฏ</th><th>ุงูุจุงูู</th><th>ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุนูุฏ</th><th>ุชุงุฑูุฎ ููุงูุฉ ุงูุนูุฏ</th><th>ููุงุญุธุงุช</th><th>ุงููููุฉ ุงููุฏููุนุฉ</th><th>ุฑูู ุงูุฅูุตุงู</th></tr></thead><tbody id="body2"></tbody></table>
  </div>

  <div class="tab-content" id="tab3">
    <div class="filters">
      <input class="nameFilter" placeholder="๐ ุงุณู ุงููุณุชุฃุฌุฑ">
      <select class="phaseFilter"><option value="">๐ ูู ุงููุฑุงุญู</option></select>
      <button class="exportBtn">๐ค ุชุตุฏูุฑ Excel</button>
    </div>
    <table><thead><tr><th>ุงููุณุชุฃุฌุฑ</th><th>ุงููุฑุญูุฉ</th><th>ุงูุฏูุฑ</th><th>ุฑูู ุงููุญู</th><th>ุงูุฅูุฌุงุฑ</th><th>ููุฏู ุงูุนูุฏ</th><th>ูููุฉ ุงูุงุณุชุซูุงุฑ</th><th>ูููุฉ ุงูุชุทููุฑ</th><th>ุชุงุฑูุฎ ุขุฎุฑ ุณุฏุงุฏ</th><th>ุงูุจุงูู</th><th>ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุนูุฏ</th><th>ุชุงุฑูุฎ ููุงูุฉ ุงูุนูุฏ</th><th>ููุงุญุธุงุช</th><th>ุงููููุฉ ุงููุฏููุนุฉ</th><th>ุฑูู ุงูุฅูุตุงู</th></tr></thead><tbody id="body3"></tbody></table>
  </div>

<script>
  const columns = ["ุงููุณุชุฃุฌุฑ", "ุงููุฑุญูุฉ", "ุงูุฏูุฑ", "ุฑูู ุงููุญู", "ุงูุฅูุฌุงุฑ", "ููุฏู ุงูุนูุฏ", "ูููุฉ ุงูุงุณุชุซูุงุฑ", "ูููุฉ ุงูุชุทููุฑ", "ุชุงุฑูุฎ ุขุฎุฑ ุณุฏุงุฏ", "ุงูุจุงูู", "ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุนูุฏ", "ุชุงุฑูุฎ ููุงูุฉ ุงูุนูุฏ", "ููุงุญุธุงุช", "ุงููููุฉ ุงููุฏููุนุฉ", "ุฑูู ุงูุฅูุตุงู"];
  let data = {};

  function showTab(i) {
    document.querySelectorAll('.tab-content').forEach((el, idx) => {
      el.classList.toggle('active', i === idx);
    });
    document.querySelectorAll('.tab-btn').forEach((btn, idx) => {
      btn.classList.toggle('active', i === idx);
    });
  }

  function renderTables() {
    const sections = [data.paid, data.commitment, data.outstanding, data.deficiencies];
    sections.forEach((rows, i) => {
      const tbody = document.getElementById('body' + i);
      const filterName = document.querySelectorAll('.nameFilter')[i];
      const filterPhase = document.querySelectorAll('.phaseFilter')[i];
      const exportBtn = document.querySelectorAll('.exportBtn')[i];

      const phases = [...new Set(rows.map(r => r['ุงููุฑุญูุฉ']))].filter(Boolean);
      phases.forEach(p => {
        const opt = document.createElement('option');
        opt.value = p; opt.textContent = p;
        filterPhase.appendChild(opt);
      });

      function applyFilters() {
        tbody.innerHTML = '';
        const nameVal = filterName.value.trim();
        const phaseVal = filterPhase.value;
        const filtered = rows.filter(r =>
          (!nameVal || r['ุงููุณุชุฃุฌุฑ']?.includes(nameVal)) &&
          (!phaseVal || r['ุงููุฑุญูุฉ'] === phaseVal)
        );
        filtered.forEach(row => {
          const tr = document.createElement('tr');
          tr.innerHTML += `<td>${row["ุงููุณุชุฃุฌุฑ"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ุงููุฑุญูุฉ"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ุงูุฏูุฑ"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ุฑูู ุงููุญู"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ุงูุฅูุฌุงุฑ"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ููุฏู ุงูุนูุฏ"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ูููุฉ ุงูุงุณุชุซูุงุฑ"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ูููุฉ ุงูุชุทููุฑ"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ุชุงุฑูุฎ ุขุฎุฑ ุณุฏุงุฏ"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ุงูุจุงูู"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุนูุฏ"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ุชุงุฑูุฎ ููุงูุฉ ุงูุนูุฏ"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ููุงุญุธุงุช"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ุงููููุฉ ุงููุฏููุนุฉ"] || ""}</td>`;
          tr.innerHTML += `<td>${row["ุฑูู ุงูุฅูุตุงู"] || ""}</td>`;
          tbody.appendChild(tr);
        });
      }

      filterName.oninput = applyFilters;
      filterPhase.onchange = applyFilters;
      applyFilters();

      exportBtn.onclick = () => {
        const tbl = exportBtn.closest('.tab-content').querySelector('table');
        const wb = XLSX.utils.table_to_book(tbl, { sheet: "ุจูุงูุงุช" });
        XLSX.writeFile(wb, 'table' + i + '.xlsx');
      };
    });
  }

  fetch('alahlisc(1).json')
    .then(res => res.json())
    .then(json => { data = json; renderTables(); });
</script>
</body>
</html>
